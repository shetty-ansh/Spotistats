<!-- <p>callback works!</p>
<div *ngIf="profile">
  <h2>Welcome, {{ profile.display_name }}</h2>
  <img *ngIf="profile.images?.length" [src]="profile.images[0].url" width="150" />
</div>
<div *ngIf="!profile">
  <p>Loading...</p>
</div>

<p>Email: {{ profile.email }}</p>
<p>Country: {{ profile.country }}</p>

<div *ngIf="topTracksShort.length">
  <h3>Top Tracks (1 Month)</h3>
  <ul>
    <li *ngFor="let track of topTracksShort">
      <img [src]="track.album.images[0].url" alt="Track Image" width="100" />
      {{ track.name }} – {{ track.artists[0]?.name }}
    </li>
  </ul>
</div>

<div *ngIf="topTracksMedium.length">
  <h3>Top Tracks (6 Months)</h3>
  <ul>
    <li *ngFor="let track of topTracksMedium">
      <img [src]="track.album.images[0].url" alt="Track Image" width="100" />
      {{ track.name }} – {{ track.artists[0]?.name }}
    </li>
  </ul>
</div>

<div *ngIf="topArtistsShort.length">
  <h3>Top Artists (1 Month)</h3>
  <ul>
    <li *ngFor="let artist of topArtistsShort">
      <img [src]="artist.images[0].url" alt="Track Image" width="100" />
      {{ artist.name }}
    </li>
  </ul>
</div>

<div *ngIf="topArtistsMedium.length">
  <h3>Top Artists (6 Months)</h3>
  <ul>
    <li *ngFor="let artist of topArtistsMedium">
      <img [src]="artist.images[0].url" alt="Track Image" width="100" />
      {{ artist.name }}
    </li>
  </ul>
</div>  -->



<!-- /////////////////////////////////////////////////////////////////////////////////////////////// -->


<!-- <div id="MainContainer">
  <div id="Header">
    <div id="ProfielSection">
      <div id="ProfileImage">
        <img *ngIf="profile.images?.length" [src]="profile.images[0].url" />
      </div>
      <div id="ProfileInfo">
        <p id="Name">{{ profile.display_name }}</p>
        <p id="Country">{{ profile.country }}</p>
      </div>
    </div>
    <div id="ToggleContainer">
      <div class="switch-container" [class.switched]="isToggled" (click)="toggleSwitch()">
        <div class="switch-slider"></div>
        <div class="switch-options">
          <div class="switch-option" [class.active]="!isToggled">Last Month</div>
          <div class="switch-option" [class.active]="isToggled">6 Months</div>

        </div>
      </div>
    </div>
  </div>

  <div class="carousel-container" *ngIf="topTracksShort.length">
    <button class="nav-button left" (click)="prevSlide()">‹</button>
    <div class="carousel-track">
      <div class="carousel-card" *ngFor="let track of visibleTracks(); let i = index" [ngClass]="getCardClass(i)">
        <div id="Image">
          <img [src]="track.album.images[0]?.url" alt="Track Image" />
          <div class="track-badge">{{ i }}</div>
        </div>
        <div class="track-info"> 
          <p id="TrackName">{{ track.name }}</p>
          <p id="ArtistName">{{ track.artists[0]?.name }}</p>
        </div>
      </div>
    </div>
    <button class="nav-button right" (click)="nextSlide()">›</button>
  </div>
</div> -->


<div class="dashboard-container">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-card">
      <h2>Loading your Spotify data...</h2>
      <div class="loading-spinner"></div>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-overlay">
    <div class="error-card">
      <h2>{{ error }}</h2>
      <p>Please try authenticating with Spotify again.</p>
    </div>
  </div>

  <!-- Main Dashboard -->
  <div *ngIf="!isLoading && !error" class="dashboard-content">
    <!-- Top row -->
    <div class="dashboard-row">
      <!-- Empty Div (Top Left) -->
      <div class="dashboard-card empty-card">
        <h3>Empty Div</h3>
        <p>Total Tracks: {{ recentTracks.length }}</p>
      </div>
      
      <!-- First Song in Recently Played -->
      <div class="dashboard-card song-card">
        <div *ngIf="firstTrack; else noFirstTrack">
          <img *ngIf="getAlbumImageUrl(firstTrack)" 
               [src]="getAlbumImageUrl(firstTrack)" 
               [alt]="getTrackName(firstTrack) + ' album cover'"
               class="album-cover"
               (error)="$event.target.style.display='none'">
          <div class="album-cover placeholder-cover" *ngIf="!getAlbumImageUrl(firstTrack)">
            <span>♪</span>
          </div>
          <h3>{{ getTrackName(firstTrack) }}</h3>
          <p class="artist-name">{{ getArtistName(firstTrack) }}</p>
          <p class="played-time" *ngIf="getPlayedAt(firstTrack)">
            Played at: {{ getPlayedAt(firstTrack) }}
          </p>
        </div>
        <ng-template #noFirstTrack>
          <div class="album-cover placeholder-cover">
            <span>♪</span>
          </div>
          <h3>First Song in recentlyPlayed</h3>
          <p>No recent tracks available</p>
        </ng-template>
      </div>
    </div>

    <!-- Bottom row -->
    <div class="dashboard-row">
      <!-- Scrollable Past Songs -->
      <div class="dashboard-card scrollable-card">
        <h3>Scrollable past {{ scrollableTracks.length }} songs</h3>
        <div class="scrollable-content" *ngIf="scrollableTracks.length > 0; else noScrollableTracks">
          <div *ngFor="let track of scrollableTracks; let i = index" 
               class="track-item"
               [attr.data-index]="i + 2">
            <img *ngIf="getAlbumImageUrl(track, 2)" 
                 [src]="getAlbumImageUrl(track, 2)" 
                 [alt]="getTrackName(track) + ' album cover'"
                 class="small-album-cover"
                 (error)="$event.target.style.display='none'">
            <div class="small-album-cover placeholder-small" *ngIf="!getAlbumImageUrl(track, 2)">
              <span>♪</span>
            </div>
            <div class="track-info">
              <span class="track-name" [title]="getTrackName(track)">
                {{ getTrackName(track) }}
              </span>
              <span class="artist-name" [title]="getArtistName(track)">
                {{ getArtistName(track) }}
              </span>
              <span class="played-time" *ngIf="getPlayedAt(track)">
                {{ getPlayedAt(track) }}
              </span>
            </div>
          </div>
        </div>
        <ng-template #noScrollableTracks>
          <div class="no-tracks-message">
            <p>No additional tracks to display</p>
            <small *ngIf="recentTracks.length === 1">You have only one recent track</small>
            <small *ngIf="recentTracks.length === 0">No recent tracks found</small>
          </div>
        </ng-template>
      </div>

      <!-- Empty Divs (Right side) -->
      <div class="dashboard-card-column">
        <div class="dashboard-card empty-card small">
          <h3>Empty Div</h3>
          <p *ngIf="token">Authenticated ✓</p>
        </div>
        <div class="dashboard-card empty-card small">
          <h3>Empty Div</h3>
          <p>Ready to expand</p>
        </div>
      </div>
    </div>
  </div>
</div>